<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Vitess - GettingStarted</title>
<meta name="description" content="A set of servers and tools that facilitate scaling of MySQL databases for the web.">

<link rel="canonical" href="http://vitess.io/doc/GettingStarted/">

<!-- Add to homescreen for Chrome on Android -->
<meta name="mobile-web-app-capable" content="yes">
<link rel="icon" sizes="196x196" href="/images/touch/chrome-touch-icon-196x196.png">

<!-- Add to homescreen for Safari on iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Vitess">

<!-- Tile icon for Win8 (144x144 + tile color) -->
<meta name="msapplication-TileImage" content="/images/touch/ms-touch-icon-144x144-precomposed.png">
<meta name="msapplication-TileColor" content="#3372DF">

<link rel="stylesheet" href="/assets/vendor/styles/wsk.css">
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/extra.css">
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,600,900|Roboto+Condensed:300,300italic,400,700">

</head>
<body class="">

<header id="app-bar" class="app-bar promote-layer">
  <div class="app-bar-container">
    <button id="menu" class="menu" title="Menu"></button>
    <h1 class="logo"><a href="/">Vitess</a></h1>
    <section class="app-bar-actions">
      <a href="#"><i class="icon icon-chevron-up"></i> Top</a>
    </section>
  </div>
</header>

<div class="navdrawer">
  <nav id="nav" class="navdrawer-container promote-layer">
    <h4>Navigation</h4>
    
<ul>
  
    <li >
      <a href="http://vitess.io//"></a>
    </li>
  
    <li >
      <a href="http://vitess.io/overview/">Overview</a>
    </li>
  
    <li >
      <a href="http://vitess.io/getting-started/">Getting Started</a>
    </li>
  
  <li><a href="https://github.com/youtube/vitess">GitHub</a></li>
</ul>

  </nav>
</div>

<main class="clear">

  <header class="page-header container">
    <h2 class="xxlarge text-divider">GettingStarted</h2>
    
  </header>

  <div class="container">
    <h1 id="getting-started">Getting Started</h1>

<p>There are two ways to build Vitess:
with <a href="https://www.docker.com/">Docker</a>, or manually.</p>

<p>If you run into issues or have questions, please post on our
<a href="https://groups.google.com/forum/#!forum/vitess">forum</a>.</p>

<h2 id="docker-build">Docker Build</h2>

<p>If you just want to run Vitess in Docker, you can use one of our
<a href="https://registry.hub.docker.com/repos/vitess/">Automated Builds</a>.
The <code>vitess/base</code> image contains a full development environment,
capable of building Vitess and running integration tests.
The <code>vitess/lite</code> image contains only the compiled Vitess binaries,
excluding ZooKeeper. It can run Vitess, but lacks the environment
needed to build it or run tests.</p>

<p>You can also build the Vitess Docker images yourself,
to include your own patches or baked-in config.
The <a href="https://github.com/youtube/vitess/blob/master/Dockerfile">Dockerfile</a>
in the root of the Vitess tree will build <code>vitess/base</code>.
Other images can be built with scripts located in the
<a href="https://github.com/youtube/vitess/tree/master/docker">docker</a> subdirectory.</p>

<h2 id="manual-build">Manual Build</h2>

<h3 id="dependencies">Dependencies</h3>

<ul>
<li>We currently develop on Ubuntu 14.04 (Trusty) and Debian 7.0 (Wheezy).</li>
<li>You&#39;ll need some kind of Java Runtime if you use ZooKeeper.
We use OpenJDK (<em>sudo apt-get install openjdk-7-jre</em>).</li>
<li><a href="http://golang.org">Go</a> 1.3+: Needed for building Vitess.</li>
<li>MySQL: We support <a href="https://mariadb.org/">MariaDB</a> 10.0
and <a href="https://www.mysql.com/">MySQL</a> 5.6.
We currently test against MariaDB 10.0.17 and MySQL 5.6.24.</li>
<li><a href="http://zookeeper.apache.org/">ZooKeeper</a>
or <a href="https://github.com/coreos/etcd">etcd</a> 0.4.6:
By default, Vitess uses ZooKeeper as the lock service.
We also have a plugin for etcd. See the Building section below.
It is possible to plug in something else as long as the new service supports
the necessary API functions.</li>
<li><a href="http://memcached.org">Memcached</a>: Used for the rowcache.</li>
<li><a href="http://python.org">Python</a> 2.7: For the client and testing.</li>
</ul>

<h3 id="building">Building</h3>

<p><a href="http://golang.org/doc/install">Install Go</a>.</p>

<p>Install <a href="https://downloads.mariadb.org/">MariaDB</a> 10.0
or <a href="http://dev.mysql.com/downloads/mysql/">MySQL</a> 5.6.
You can use any installation method (src/bin/rpm/deb),
but be sure to include the client development headers
(<strong>libmariadbclient-dev</strong> or <strong>libmysqlclient-dev</strong>).</p>

<p>ZooKeeper 3.3.5 is included by default. If you plan to use it, you don&#39;t need
to install anything else.</p>

<p>If you want to use etcd instead, install
<a href="https://github.com/coreos/etcd/releases/tag/v0.4.6">etcd 0.4.6</a>
and make sure the &quot;etcd&quot; command is on your path.</p>

<p>Then download and build Vitess. Note that the value of MYSQL_FLAVOR is case-sensitive.
If the mysql_config command from libmariadbclient-dev is not on the PATH,
you&#39;ll need to <em>export VT_MYSQL_ROOT=/path/to/mariadb</em> before running bootstrap.sh,
where mysql_config is found at /path/to/mariadb/<strong>bin</strong>/mysql_config.</p>

<p>Also note that the bootstrap script needs to download some dependencies,
so if your machine requires a proxy to access the internet, you&#39;ll need to
set the usual environment variables (e.g. http_proxy, https_proxy, no_proxy).</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">cd</span> <span class="nv">$WORKSPACE</span>
sudo apt-get install make automake libtool memcached python-dev python-virtualenv python-mysqldb libssl-dev g++ mercurial git pkg-config bison curl unzip
git clone https://github.com/youtube/vitess.git src/github.com/youtube/vitess
<span class="nb">cd </span>src/github.com/youtube/vitess

<span class="c"># Pick one of these:</span>
<span class="nb">export </span><span class="nv">MYSQL_FLAVOR</span><span class="o">=</span>MariaDB
<span class="nb">export </span><span class="nv">MYSQL_FLAVOR</span><span class="o">=</span>MySQL56

./bootstrap.sh
. ./dev.env
make build
</code></pre></div>
<h3 id="testing">Testing</h3>

<p>If you want to use etcd, set the following environment variable:</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">export </span><span class="nv">VT_TEST_FLAGS</span><span class="o">=</span><span class="s1">&#39;--topo-server-flavor=etcd&#39;</span>
</code></pre></div>
<p>The full set of tests included in the default <em>make</em> and <em>make test</em> targets
is intended for use by Vitess developers to verify code changes.
These tests simulate a small cluster by launching many servers on the local
machine, so they require a lot of resources (minimum 8GB RAM and SSD recommended).</p>

<p>If you are only interested in checking that Vitess is working in your
environment, you can run a set of lighter tests:</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">make site_test
</code></pre></div>
<h4 id="common-test-issues">Common Test Issues</h4>

<p>Many common failures come from running the full developer test suite
(<em>make</em> or <em>make test</em>) on an underpowered machine. If you still get
these errors with the lighter set of site tests (<em>make site_test</em>),
please let us know on the mailing list.</p>

<h5 id="node-already-exists,-port-in-use,-etc.">Node already exists, port in use, etc.</h5>

<p>Sometimes a failed test may leave behind orphaned processes.
If you use the default settings, you can find these by looking for
<em>vtdataroot</em> in the command line, since every process is told to put
its files there with a command line flag. For example:</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">pgrep -f -l <span class="s1">&#39;(vtdataroot|VTDATAROOT)&#39;</span> <span class="c"># list Vitess processes</span>
pkill -f <span class="s1">&#39;(vtdataroot|VTDATAROOT)&#39;</span> <span class="c"># kill Vitess processes</span>
</code></pre></div>
<h5 id="too-many-connections-to-mysql,-or-other-timeouts">Too many connections to MySQL, or other timeouts</h5>

<p>This often means your disk is too slow. If you don&#39;t have access to an SSD,
you can try <a href="http://vitess.io/doc/TestingOnARamDisk">testing against a ramdisk</a>.</p>

<h5 id="connection-refused-to-tablet,-mysql-socket-not-found,-etc.">Connection refused to tablet, MySQL socket not found, etc.</h5>

<p>This could mean you ran out of RAM and a server crashed when it tried to allocate more.
Some of the heavier tests currently require up to 8GB RAM.</p>

<h5 id="connection-refused-in-zkctl-test">Connection refused in zkctl test</h5>

<p>This could indicate that no Java Runtime is installed.</p>

<h5 id="running-out-of-disk-space">Running out of disk space</h5>

<p>Some of the larger tests use up to 4GB of temporary space on disk.</p>

<h2 id="setting-up-a-cluster">Setting up a cluster</h2>

<p>Once you have a successful <code>make build</code>, you can proceed to start up a
<a href="https://github.com/youtube/vitess/tree/master/examples/local">local cluster</a>
for testing.</p>

<p>You can do that either with the manual build, or inside a Docker container.</p>

  </div>

</main>


<footer>
  <div class="container">
    <p class="small">&copy; 2015 Google. Licensed under <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.</p>
  </div>
</footer>

<script src="/assets/scripts/main.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  if (window.location.hostname == 'youtube.github.io') {
    ga('create', 'UA-60219601-1', 'auto');
    ga('send', 'pageview');
  }
</script>

</body>
</html>

